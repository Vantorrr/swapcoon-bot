# üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –¥–ª—è SwapCoon

## üéØ –ß—Ç–æ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ Google –¢–∞–±–ª–∏—Ü—É —Å 5 –ª–∏—Å—Ç–∞–º–∏:

1. **üìä Orders** - –≤—Å–µ –∑–∞–∫–∞–∑—ã —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
2. **üë• Staff** - –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –∏ –∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞  
3. **üìà Daily_Stats** - –¥–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
4. **üë§ Users** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
5. **üõ°Ô∏è AML_Monitoring** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫—Ä—É–ø–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## üîß –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: Google Cloud Console
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [console.cloud.google.com](https://console.cloud.google.com)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í –ø–æ–∏—Å–∫–µ –Ω–∞–π–¥–∏—Ç–µ "Google Sheets API" –∏ –≤–∫–ª—é—á–∏—Ç–µ –µ–≥–æ

### –®–∞–≥ 2: Service Account
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "IAM & Admin" ‚Üí "Service Accounts"
2. –ù–∞–∂–º–∏—Ç–µ "Create Service Account"
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: `swapcoon-sheets`)
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å "Editor"
5. –ù–∞–∂–º–∏—Ç–µ "Done"

### –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–∞
1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Service Account
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É "Keys"
3. –ù–∞–∂–º–∏—Ç–µ "Add Key" ‚Üí "Create new key"
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø "JSON" –∏ —Å–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [sheets.google.com](https://sheets.google.com)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É
3. –î–∞–π—Ç–µ –µ–π –Ω–∞–∑–≤–∞–Ω–∏–µ "SwapCoon Analytics"
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ã –∏–∑ URL (—á–∞—Å—Ç—å –º–µ–∂–¥—É `/d/` –∏ `/edit`)

### –®–∞–≥ 5: –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞
1. –í Google –¢–∞–±–ª–∏—Ü–µ –Ω–∞–∂–º–∏—Ç–µ "Share"
2. –î–æ–±–∞–≤—å—Ç–µ email –∏–∑ JSON —Ñ–∞–π–ª–∞ (–ø–æ–ª–µ `client_email`)
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∞ "Editor"
4. –ù–∞–∂–º–∏—Ç–µ "Send"

### –®–∞–≥ 6: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `config/google-sheets.json`
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ JSON –≤ –ø–æ–ª–µ `credentials`
3. –í—Å—Ç–∞–≤—å—Ç–µ ID —Ç–∞–±–ª–∏—Ü—ã –≤ –ø–æ–ª–µ `spreadsheet_id`
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `"enabled": true`

### –®–∞–≥ 7: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞
Ctrl+C

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞
node src/bot.js
```

## üìã –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```json
{
  "credentials": {
    "type": "service_account",
    "project_id": "your-project-123456",
    "private_key_id": "abc123...",
    "private_key": "-----BEGIN PRIVATE KEY-----\nYOUR_KEY_HERE\n-----END PRIVATE KEY-----\n",
    "client_email": "swapcoon-sheets@your-project-123456.iam.gserviceaccount.com",
    "client_id": "123456789...",
    "auth_uri": "https://accounts.google.com/o/oauth2/auth",
    "token_uri": "https://oauth2.googleapis.com/token"
  },
  "spreadsheet_id": "1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p7q8r9s0t",
  "enabled": true,
  "auto_export_interval": 3600000
}
```

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–æ—Ä—Ç
- –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π —á–∞—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `auto_export_interval` (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö)

### üéÆ –†—É—á–Ω–æ–π —ç–∫—Å–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- `/admin` ‚Üí `‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏` ‚Üí `üìã Google Sheets`
- –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

#### –õ–∏—Å—Ç "Orders"
- ID –∑–∞–∫–∞–∑–∞, –¥–∞—Ç–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- –í–∞–ª—é—Ç–Ω—ã–µ –ø–∞—Ä—ã –∏ —Å—É–º–º—ã
- –°—Ç–∞—Ç—É—Å, –æ–ø–µ—Ä–∞—Ç–æ—Ä, –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- AML —Å—Ç–∞—Ç—É—Å, –ø—Ä–∏–±—ã–ª—å, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### –õ–∏—Å—Ç "Staff"  
- ID, –∏–º—è, —Ä–æ–ª—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- –û–±—â–∏–µ —Å—É–º–º—ã –∏ –∫–æ–º–∏—Å—Å–∏–∏
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### –õ–∏—Å—Ç "Daily_Stats"
- –î–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∑–∞–∫–∞–∑–∞–º
- –û–±–æ—Ä–æ—Ç—ã –∏ –ø—Ä–∏–±—ã–ª—å
- –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

#### –õ–∏—Å—Ç "Users"
- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤  
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

#### –õ–∏—Å—Ç "AML_Monitoring"
- –ö—Ä—É–ø–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (>$1000)
- AML —Å—Ç–∞—Ç—É—Å—ã –∏ —Ä–∏—Å–∫-—Å–∫–æ—Ä—ã
- –ë–ª–æ–∫—á–µ–π–Ω –∞–Ω–∞–ª–∏–∑
- –î–µ–π—Å—Ç–≤–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "Google Sheets –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å JSON –∫–ª—é—á–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Service Account –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ç–∞–±–ª–∏—Ü–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Google Sheets API –≤–∫–ª—é—á–µ–Ω

### –û—à–∏–±–∫–∞ "Permission denied"
- –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ç–∞–±–ª–∏—Ü–µ–π —Å email –∏–∑ `client_email`
- –í—ã–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ "Editor"

### –û—à–∏–±–∫–∞ "Spreadsheet not found"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å `spreadsheet_id`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:
- ‚úÖ –ö—Ä–∞—Å–∏–≤—É—é –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫—É—é —Ç–∞–±–ª–∏—Ü—É
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö  
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ –∏ —Å–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ Google Sheets)
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV/Excel –∏–∑ Google Sheets
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è –∫–æ–º–∞–Ω–¥—ã

–í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ SwapCoon —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –ø–æ–¥ —Ä—É–∫–æ–π! üöÄ 